plot(decomposition)
# Check for seasonality using seasonal plots
seasonplot(x4_ts)
ggseasonplot(x4_ts)
monthplot(x4_ts)
# Examine the autocorrelation function (ACF) and partial autocorrelation function (PACF)
acf(x4_ts)
pacf(x4_ts)
# Assuming you have your data stored in a matrix 'data'
# Set the maximum lag order you want to consider
max_k <- 10
# Estimate the VAR model for lag orders from 1 to 'max_k'
var_models <- lapply(1:max_k, function(k) VAR(variables, p = k, type = "const"))
# Calculate the AIC values for each VAR model
aic_values <- sapply(var_models, function(model) AIC(model))
# Find the lag order with the minimum AIC
min_aic <- min(aic_values)
best_k <- which.min(aic_values)
# Print the AIC values and the lag order with the minimum AIC
cat("AIC values:", "\n")
print(aic_values)
cat("\n")
cat("Best lag order (minimum AIC):", best_k, "\n")
# Perform the Johansen cointegration test with best lag from AIC
x <- data[, c("x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8", "x9", "x10")]
johansen_result <- ca.jo(variables, type = "trace", K = 5, ecdet = "none", spec = "longrun")
summary(johansen_result)
# Perform the Johansen cointegration test with best lag from AIC
johansen_result <- ca.jo(variables, type = "trace", K = 5, ecdet = "none", spec = "longrun")
summary(johansen_result)
# Perform the Johansen cointegration test with best lag from AIC
johansen_result <- ca.jo(variables, type = "trace", K = 5, ecdet = "none", spec = "longrun")
summary(johansen_result)
# Perform the Johansen cointegration test with best lag from AIC
johansen_result <- ca.jo(variables, type = "trace", K = 2, ecdet = "none", spec = "longrun")
summary(johansen_result)
# Perform the Johansen cointegration test with best lag from AIC
johansen_result <- ca.jo(variables, type = "trace", K = 4, ecdet = "none", spec = "longrun")
summary(johansen_result)
# Perform the Johansen cointegration test with best lag from AIC
johansen_result <- ca.jo(variables, type = "trace", K = 5, ecdet = "none", spec = "longrun")
# Perform the Johansen cointegration test with best lag from AIC
johansen_result <- ca.jo(variables, type = "trace", K = 5, ecdet = "none", spec = "longrun")
library(forecast)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
testdf <- function(variable, max.augmentations)
{
require(fUnitRoots)
require(lmtest)
results_adf <- data.frame(augmentations = -1, adf = 0, p_adf = 0, bgodfrey = 0, p_bg = 0)
variable <- coredata(variable[!is.na(variable)])
for(augmentations in 0:max.augmentations)
{
df.test_ <- adfTest(variable, lags = augmentations, type = "c")
df_ <- as.numeric(df.test_@test$statistic)
p_adf <- as.numeric(df.test_@test$p.value)
resids_ <- df.test_@test$lm$residuals
bgtest_ <- bgtest(resids_~1, order = 1)
bgodfrey <- bgtest_$statistic
names(bgodfrey) <- NULL
p_bg <- bgtest_$p.value
results_adf <- rbind(results_adf, data.frame(augmentations = augmentations, adf = df_, p_adf = p_adf,
bgodfrey = bgodfrey, p_bg = p_bg))
rm(df.test_, df_, resids_, bgtest_, bgodfrey, p_bg)
}
results_adf <- results_adf[results_adf$augmentations >= 0,]
row.names(results_adf) <- NULL
plot(variable, type = "l", col = "darkblue", lwd = 2,
main = "Plot of the examined variable")
return(results_adf)
}
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], order.by=as.Date(data$date))
dx1 <- diff.xts(data$x1)
dx2 <- diff.xts(data$x2)
dx3 <- diff.xts(data$x3)
dx4 <- diff.xts(data$x4)
dx5 <- diff.xts(data$x5)
dx6 <- diff.xts(data$x6)
dx7 <- diff.xts(data$x7)
dx8 <- diff.xts(data$x8)
dx9 <- diff.xts(data$x9)
dx10 <- diff.xts(data$x10)
data$dx1 <- dx1
data$dx2 <- dx2
data$dx3 <- dx3
data$dx4 <- dx4
data$dx5 <- dx5
data$dx6 <- dx6
data$dx7 <- dx7
data$dx8 <- dx8
data$dx9 <- dx9
data$dx10 <- dx10
testdf(variable = data$x1, max.augmentations = 3)
testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x7, max.augmentations = 3)
testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x4, max.augmentations = 3)
testdf(variable = data$dx1, max.augmentations = 3)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$date <- as.Date(data$date)
variables <- data[, c("x1", "x2", "x3", "x5", "x6", "x7", "x8", "x9", "x10")]
# Perform ADF test for each variable
adf_results <- lapply(variables, adf.test)
# Extract the test statistics and p-values
adf_stats <- sapply(adf_results, function(x) x$statistic)
adf_pvalues <- sapply(adf_results, function(x) x$p.value)
variables <- data[, c("x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8", "x9", "x10")]
# Perform ADF test for each variable
adf_results <- lapply(variables, adf.test)
# Extract the test statistics and p-values
adf_stats <- sapply(adf_results, function(x) x$statistic)
adf_pvalues <- sapply(adf_results, function(x) x$p.value)
# Print the ADF test results for each variable
for (i in seq_along(adf_results)) {
cat("ADF Test Results for", colnames(data)[i+1], ":\n")
cat("Test statistic:", adf_stats[i], "\n")
cat("p-value:", adf_pvalues[i], "\n\n")
}
View(testdf)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
testdf(variable = data$x4, max.augmentations = 3)
data <- xts(data[, -1], order.by=as.Date(data$date))
testdf(variable = data$x4, max.augmentations = 3)
#testdf(variable = data$dx1, max.augmentations = 3)
head(data)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data <- xts(data[, -1], order.by=as.Date(data$date))
testdf(variable = data$x4, max.augmentations = 3)
source('testdf.r')
testdf(variable = data$x4, max.augmentations = 3)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data <- xts(data[, -1], order.by=as.Date(data$Date))
testdf(variable = data$x4, max.augmentations = 3)
testdf(variable = data$x5, max.augmentations = 3)
data <- xts(data[, -1], order.by=as.Date(data$Date))
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
testdf(variable = data$x5, max.augmentations = 3)
#testdf(variable = data$dx1, max.augmentations = 3)
data <- xts(data[, -1], order.by=as.Date(data$date))
testdf(variable = data$x5, max.augmentations = 3)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
testdf(variable = data$x5, max.augmentations = 3)
#testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x5, max.augmentations = 5)
#testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x5, max.augmentations = 9)
#testdf(variable = data$dx1, max.augmentations = 3)
data <- xts(data[, -1], order.by=as.Date(data$Date))
testdf(variable = data$x5, max.augmentations = 9)
class(x5)
class(data$x5)
class(data)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
testdf(variable = data$x5, max.augmentations = 9)
#testdf(variable = data$dx1, max.augmentations = 3)
model.coint <- lm(data$x1 ~ data$x2, data = data)
summary(model.coint)
dx1 <- diff.xts(data$x1)
dx2 <- diff.xts(data$x2)
dx3 <- diff.xts(data$x3)
dx4 <- diff.xts(data$x4)
dx5 <- diff.xts(data$x5)
dx6 <- diff.xts(data$x6)
dx7 <- diff.xts(data$x7)
dx8 <- diff.xts(data$x8)
dx9 <- diff.xts(data$x9)
dx10 <- diff.xts(data$x10)
data$dx1 <- dx1
data$dx2 <- dx2
data$dx3 <- dx3
data$dx4 <- dx4
data$dx5 <- dx5
data$dx6 <- dx6
data$dx7 <- dx7
data$dx8 <- dx8
data$dx9 <- dx9
data$dx10 <- dx10
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx2, max.augmentations = 3)
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx3, max.augmentations = 3)
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx5, max.augmentations = 3)
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx9, max.augmentations = 3)
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx1, max.augmentations = 3)
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
model.coint <- lm(data$x1 ~ data$x9, data = data)
summary(model.coint)
testdf(variable = residuals(model.coint), max.augmentations = 3)
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], order.by=as.Date(data$Date))
head(data)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], order.by=as.Date(data$Date))
head(data)
data %>% glimpse()
head(data)
tail(data)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
model.coint <- lm(data$x1 ~ data$x9, data = data)
summary(model.coint)
testdf(variable = residuals(model.coint), max.augmentations = 3)
testdf(variable = residuals(model.coint), max.augmentations = 10)
testdf(variable = residuals(model.coint), max.augmentations = 20)
testdf(variable = residuals(model.coint), max.augmentations = 200)
data$resid <- xts(residuals(model.coint))
model.ecm <- lm(data$x1 ~ data$x2 + resid, data = data)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
x4_ts <- ts(data[, 2], start = min(data$Date), end = max(data$Date))
head(data)
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x4, max.augmentations = 9)
#testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x7, max.augmentations = 9)
#testdf(variable = data$dx4, max.augmentations = 3)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
x4_ts <- ts(data[, 2], start = min(data$Date), end = max(data$Date), frequency = 365)
testdf(variable = data$x7, max.augmentations = 9)
#testdf(variable = data$dx4, max.augmentations = 3)
dx1 <- diff.xts(data$x1)
dx2 <- diff.xts(data$x2)
dx3 <- diff.xts(data$x3)
dx4 <- diff.xts(data$x4)
dx5 <- diff.xts(data$x5)
dx6 <- diff.xts(data$x6)
dx7 <- diff.xts(data$x7)
dx8 <- diff.xts(data$x8)
dx9 <- diff.xts(data$x9)
dx10 <- diff.xts(data$x10)
data$dx1 <- dx1
data$dx2 <- dx2
data$dx3 <- dx3
data$dx4 <- dx4
data$dx5 <- dx5
data$dx6 <- dx6
data$dx7 <- dx7
data$dx8 <- dx8
data$dx9 <- dx9
data$dx10 <- dx10
testdf(variable = data$x7, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
#testdf(variable = data$x7, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
#testdf(variable = data$x7, max.augmentations = 9)
testdf(variable = data$dx7, max.augmentations = 3)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- ts(data[, 2], start = min(data$Date), end = max(data$Date), frequency = 365)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, 2], start = min(data$Date), end = max(data$Date), frequency = 365)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, -1], start = min(data$Date), end = max(data$Date), frequency = 365)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, -1], start = min(data$Date), end = max(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[ , -1], start = min(data$Date), end = max(data$Date))
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[ , -1], start = min(data$Date), end = max(data$Date))
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
#data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[ , -1], start = min(data$Date), end = max(data$Date))
data <- xts(data[, 1], order.by=as.Date(data$Date))
head(data)
dx1 <- diff.xts(data$x1)
data <- xts(data[, -1], order.by=as.Date(data$Date))
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, 1], order.by=as.Date(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$Date))
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], order.by=as.Date(data$Date))
head(data)
data <- xts(data[, -1], start = min(data$Date), end = max(data$Date))
head(data)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], start = min(data$Date), end = max(data$Date))
data <- xts(data[, -1], order.by= as.Date(data$Date))
View(data)
View(data)
View(data)
View(data)
data <- xts(data[, 1], order.by=as.Date(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$Date))
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
data <- xts(data[, -1], order.by= data$Date)
View(data)
View(data)
source('testdf.r')
View(data)
View(data)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
View(data)
data <- xts(data[, -1], order.by= data$date)
data <- xts(data[, -1], order.by= data$Date)
head(data)
data <- xts(data[, 1], order.by= data$Date)
library(forecast)
library(vars)
library(tidyverse)
library(knitr)
library(urca)
library(tseries)
library(xts)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
data %>% glimpse()
head(data)
tail(data)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
source('testdf.r')
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
data <- xts(data[, -1], order.by=as.Date(data$Date))
testdf(variable = data$x4, max.augmentations = 9)
data$Date <- as.Date(data[, 1])
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$Date <- as.Date(data[, 1])
head(data)
data$date <- as.Date(data[, 1])
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$date <- as.Date(data[, 1])
head(data)
source('testdf.r')
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$date <- as.Date(data[, 1])
head(data)
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$date
data <- read.csv("C:/Users/Asus/Downloads/TSA_2023_project_data_1.csv")
data$date
data$date <- as.Date(data[, 1], format = '%d/%m/%Y')
head(data)
data <- xts(data[, -1], order.by=as.Date(data$Date))
data <- xts(data[, -1], order.by=as.Date(data$date))
head(data)
dx1 <- diff.xts(data$x1)
dx2 <- diff.xts(data$x2)
dx4 <- diff.xts(data$x4)
dx5 <- diff.xts(data$x5)
dx6 <- diff.xts(data$x6)
dx7 <- diff.xts(data$x7)
dx8 <- diff.xts(data$x8)
dx9 <- diff.xts(data$x9)
dx10 <- diff.xts(data$x10)
data$dx1 <- dx1
data$dx3 <- dx3
data$dx4 <- dx4
data$dx5 <- dx5
data$dx7 <- dx7
data$dx8 <- dx8
data$dx9 <- dx9
data$dx10 <- dx10
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x1, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x8, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x4, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
testdf(variable = data$x2, max.augmentations = 9)
testdf(variable = data$dx4, max.augmentations = 3)
